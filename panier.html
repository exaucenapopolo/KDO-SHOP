<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Panier - KDO CAMEROUN</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- CSS personnalisé -->
    <style>
        :root {
            --primary-orange: #FF6B00;
            --secondary-blue: #0066CC;
            --accent-gray: #F5F5F5;
            --text-dark: #333333;
            --text-medium: #666666;
            --text-light: #999999;
            --border-color: #E0E0E0;
            --white: #FFFFFF;
            --shadow: 0 1px 3px rgba(0,0,0,0.08);
            --shadow-hover: 0 3px 10px rgba(0,0,0,0.1);
            --success-green: #52C41A;
            --danger-red: #FF4D4F;
            --warning-yellow: #FAAD14;
        }
        
        * {
            font-size: 12px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: var(--white);
            color: var(--text-dark);
            padding-bottom: 50px;
            -webkit-text-size-adjust: 100%;
        }
        
        /* Header simplifié */
        .header-kdo {
            border-bottom: 1px solid var(--border-color);
            background: var(--white);
            padding: 8px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .logo-img {
            height: 32px;
            width: auto;
            object-fit: contain;
        }
        
        .logo-text {
            color: var(--primary-orange);
            font-weight: 700;
            font-size: 16px;
            letter-spacing: -0.5px;
        }
        
        /* Barre de recherche */
        .search-wrapper {
            position: relative;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .search-input {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 8px 40px 8px 12px;
            font-size: 12px;
            width: 100%;
            height: 36px;
        }
        
        .search-input:focus {
            border-color: var(--primary-orange);
            box-shadow: 0 0 0 2px rgba(255, 107, 0, 0.1);
        }
        
        .search-btn {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            background: var(--accent-gray);
            color: var(--text-medium);
            border: none;
            border-radius: 0 4px 4px 0;
            padding: 0 15px;
            font-size: 12px;
            cursor: pointer;
        }
        
        .search-btn:hover {
            background: var(--primary-orange);
            color: white;
        }
        
        /* Barre de progression */
        .checkout-progress {
            background: var(--accent-gray);
            border-bottom: 1px solid var(--border-color);
            padding: 12px 0;
            margin-bottom: 20px;
        }
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .step-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--white);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 5px;
            transition: all 0.3s;
        }
        
        .step-label {
            font-size: 11px;
            color: var(--text-light);
            font-weight: 500;
            text-align: center;
        }
        
        .progress-step.active .step-icon {
            background: var(--primary-orange);
            border-color: var(--primary-orange);
            color: white;
        }
        
        .progress-step.active .step-label {
            color: var(--primary-orange);
            font-weight: 600;
        }
        
        .progress-step.completed .step-icon {
            background: var(--success-green);
            border-color: var(--success-green);
            color: white;
        }
        
        .progress-step.completed .step-label {
            color: var(--success-green);
        }
        
        .progress-line {
            position: absolute;
            top: 18px;
            left: 50px;
            right: 50px;
            height: 2px;
            background: var(--border-color);
            z-index: 1;
        }
        
        .progress-line-filled {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: var(--primary-orange);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        /* Page de connexion */
        .login-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 30px;
            background: var(--white);
            border-radius: 10px;
            box-shadow: var(--shadow-hover);
            border: 1px solid var(--border-color);
        }
        
        .login-title {
            text-align: center;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-orange);
            margin-bottom: 30px;
        }
        
        .login-btn {
            width: 100%;
            background: var(--primary-orange);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 12px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .login-btn:hover {
            background: #E55A00;
            transform: translateY(-2px);
        }
        
        .login-links {
            text-align: center;
            margin-top: 20px;
        }
        
        .login-links a {
            color: var(--primary-orange);
            text-decoration: none;
        }
        
        .login-links a:hover {
            text-decoration: underline;
        }
        
        /* Contenu principal */
        .checkout-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .checkout-content {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        /* Colonne gauche - Étapes du paiement */
        .checkout-steps {
            flex: 1;
        }
        
        .checkout-step {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            display: none;
        }
        
        .checkout-step.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .step-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .step-number {
            background: var(--primary-orange);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }
        
        /* Étape 1 - Articles du panier */
        .cart-items-container {
            margin-bottom: 20px;
        }
        
        .cart-item {
            display: flex;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .cart-item-image {
            width: 100px;
            height: 100px;
            background: var(--accent-gray);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .cart-item-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .cart-item-details {
            flex: 1;
        }
        
        .cart-item-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .cart-item-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin: 0 0 5px;
            line-height: 1.3;
        }
        
        .cart-item-supplier {
            font-size: 11px;
            color: var(--text-medium);
            margin: 0;
        }
        
        .cart-item-price {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-orange);
            text-align: right;
        }
        
        .cart-item-price span {
            font-size: 12px;
            color: var(--text-light);
            text-decoration: line-through;
            margin-left: 5px;
        }
        
        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .quantity-btn {
            width: 28px;
            height: 28px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            color: var(--text-dark);
            transition: all 0.2s;
        }
        
        .quantity-btn:hover {
            background: var(--accent-gray);
            border-color: var(--primary-orange);
        }
        
        .quantity-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .quantity-input {
            width: 50px;
            text-align: center;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 6px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .cart-item-remove {
            background: none;
            border: none;
            color: var(--danger-red);
            font-size: 12px;
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-left: auto;
        }
        
        .cart-item-remove:hover {
            text-decoration: underline;
        }
        
        .cart-empty {
            text-align: center;
            padding: 40px 20px;
        }
        
        .cart-empty-icon {
            font-size: 64px;
            color: var(--border-color);
            margin-bottom: 20px;
        }
        
        .cart-empty-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-medium);
            margin-bottom: 10px;
        }
        
        .cart-empty-text {
            font-size: 13px;
            color: var(--text-light);
            max-width: 400px;
            margin: 0 auto 25px;
            line-height: 1.5;
        }
        
        .cart-empty-btn {
            background: var(--primary-orange);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .cart-empty-btn:hover {
            background: #E55A00;
            color: white;
            text-decoration: none;
            transform: translateY(-1px);
            box-shadow: var(--shadow-hover);
        }
        
        /* Étape 2 - Livraison */
        .delivery-options {
            margin-bottom: 25px;
        }
        
        .delivery-option {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .delivery-option:hover {
            border-color: var(--primary-orange);
        }
        
        .delivery-option.selected {
            border-color: var(--primary-orange);
            background: rgba(255, 107, 0, 0.05);
        }
        
        .delivery-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }
        
        .delivery-icon {
            font-size: 20px;
            color: var(--primary-orange);
        }
        
        .delivery-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin: 0;
        }
        
        .delivery-price {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-orange);
            margin-left: auto;
        }
        
        .delivery-desc {
            font-size: 12px;
            color: var(--text-medium);
            margin: 5px 0 0;
            line-height: 1.4;
        }
        
        .delivery-time {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: rgba(82, 196, 26, 0.1);
            color: var(--success-green);
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-top: 8px;
        }
        
        .address-form {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 6px;
        }
        
        .form-control {
            width: 100%;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 10px 12px;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .form-control:focus {
            border-color: var(--primary-orange);
            box-shadow: 0 0 0 2px rgba(255, 107, 0, 0.1);
            outline: none;
        }
        
        .form-select {
            width: 100%;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 10px 12px;
            font-size: 13px;
            background: var(--white);
            cursor: pointer;
        }
        
        .form-select:focus {
            border-color: var(--primary-orange);
            box-shadow: 0 0 0 2px rgba(255, 107, 0, 0.1);
            outline: none;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-hint {
            font-size: 11px;
            color: var(--text-light);
            margin-top: 4px;
        }
        
        .form-check {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .form-check-input {
            margin-top: 3px;
        }
        
        .form-check-label {
            font-size: 12px;
            color: var(--text-medium);
            line-height: 1.5;
            cursor: pointer;
        }
        
        /* Étape 3 - Paiement */
        .payment-options {
            margin-bottom: 25px;
        }
        
        .payment-option {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .payment-option:hover {
            border-color: var(--primary-orange);
        }
        
        .payment-option.selected {
            border-color: var(--primary-orange);
            background: rgba(255, 107, 0, 0.05);
        }
        
        .payment-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
        }
        
        .payment-icon {
            font-size: 24px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--accent-gray);
            border-radius: 6px;
            color: var(--text-dark);
        }
        
        .payment-icon.orange { color: var(--primary-orange); }
        .payment-icon.blue { color: var(--secondary-blue); }
        .payment-icon.green { color: var(--success-green); }
        .payment-icon.red { color: #D0021B; }
        .payment-icon.purple { color: #7B61FF; }
        
        .payment-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin: 0;
            flex: 1;
        }
        
        .payment-desc {
            font-size: 12px;
            color: var(--text-medium);
            margin: 0 0 0 50px;
            line-height: 1.4;
        }
        
        .payment-security {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed var(--border-color);
        }
        
        .security-badge {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 11px;
            color: var(--success-green);
            font-weight: 600;
        }
        
        .payment-info {
            background: var(--accent-gray);
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
            border-left: 3px solid var(--primary-orange);
        }
        
        .payment-info-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }
        
        .payment-info-text {
            font-size: 12px;
            color: var(--text-medium);
            margin: 0;
            line-height: 1.5;
        }
        
        /* Étape 4 - Confirmation */
        .order-summary-section {
            background: var(--accent-gray);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .summary-section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .summary-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .summary-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .summary-section-title i {
            color: var(--primary-orange);
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
        }
        
        .summary-item:last-child {
            margin-bottom: 0;
        }
        
        .summary-label {
            color: var(--text-medium);
        }
        
        .summary-value {
            font-weight: 500;
            color: var(--text-dark);
        }
        
        .summary-total {
            display: flex;
            justify-content: space-between;
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-orange);
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid var(--border-color);
        }
        
        .address-display {
            background: var(--white);
            border-radius: 6px;
            padding: 15px;
            border: 1px solid var(--border-color);
        }
        
        .address-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 5px;
        }
        
        .address-details {
            font-size: 12px;
            color: var(--text-medium);
            line-height: 1.5;
            margin-bottom: 8px;
        }
        
        .address-contact {
            font-size: 12px;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .terms-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin: 25px 0;
        }
        
        .terms-checkbox input {
            margin-top: 3px;
        }
        
        .terms-label {
            font-size: 12px;
            color: var(--text-medium);
            line-height: 1.5;
        }
        
        .terms-label a {
            color: var(--primary-orange);
            text-decoration: none;
        }
        
        .terms-label a:hover {
            text-decoration: underline;
        }
        
        /* Colonne droite - Résumé */
        .order-summary-sidebar {
            width: 320px;
            flex-shrink: 0;
        }
        
        .summary-card {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--white);
            position: sticky;
            top: 100px;
        }
        
        .summary-header {
            background: var(--accent-gray);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            border-radius: 8px 8px 0 0;
        }
        
        .summary-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .summary-body {
            padding: 20px;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 13px;
        }
        
        .summary-row.savings {
            color: var(--success-green);
            font-weight: 600;
        }
        
        .summary-row.delivery {
            padding-bottom: 10px;
            margin-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .summary-row.taxes {
            padding-bottom: 15px;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .summary-row.total {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-orange);
        }
        
        .summary-row .label {
            color: var(--text-medium);
        }
        
        .summary-row .value {
            font-weight: 500;
        }
        
        .summary-discount {
            margin-top: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #FFF8F3 0%, #FFF 100%);
            border-radius: 6px;
            border: 1px solid rgba(255, 107, 0, 0.2);
        }
        
        .discount-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--primary-orange);
            margin-bottom: 8px;
        }
        
        .discount-input-group {
            display: flex;
            gap: 8px;
        }
        
        .discount-input {
            flex: 1;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 8px 12px;
            font-size: 12px;
        }
        
        .discount-btn {
            background: var(--primary-orange);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 15px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .discount-btn:hover {
            background: #E55A00;
        }
        
        /* Navigation entre étapes */
        .step-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .btn-prev {
            background: var(--white);
            border: 1px solid var(--border-color);
            color: var(--text-dark);
            border-radius: 4px;
            padding: 10px 25px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .btn-prev:hover {
            background: var(--accent-gray);
            border-color: var(--primary-orange);
            color: var(--primary-orange);
        }
        
        .btn-next, .btn-confirm {
            background: var(--primary-orange);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 30px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .btn-next:hover, .btn-confirm:hover {
            background: #E55A00;
            transform: translateY(-1px);
            box-shadow: var(--shadow-hover);
        }
        
        .btn-next:disabled, .btn-confirm:disabled {
            background: var(--text-light);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Notification de succès */
        .order-success {
            text-align: center;
            padding: 40px 20px;
        }
        
        .success-icon {
            font-size: 64px;
            color: var(--success-green);
            margin-bottom: 20px;
            animation: bounce 1s ease;
        }
        
        @keyframes bounce {
            0%, 20%, 60%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            80% {
                transform: translateY(-5px);
            }
        }
        
        .success-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
        }
        
        .success-subtitle {
            font-size: 16px;
            color: var(--success-green);
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .success-message {
            font-size: 14px;
            color: var(--text-medium);
            max-width: 600px;
            margin: 0 auto 30px;
            line-height: 1.6;
        }
        
        .order-details {
            background: var(--accent-gray);
            border-radius: 8px;
            padding: 20px;
            max-width: 500px;
            margin: 0 auto 30px;
            text-align: left;
        }
        
        .order-id {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-orange);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .order-id span {
            background: var(--white);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .order-timeline {
            margin-top: 25px;
        }
        
        .timeline-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .timeline-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--white);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: var(--text-light);
            flex-shrink: 0;
        }
        
        .timeline-content {
            flex: 1;
        }
        
        .timeline-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 3px;
        }
        
        .timeline-desc {
            font-size: 12px;
            color: var(--text-medium);
            margin: 0;
        }
        
        /* Footer avec navigation fonctionnelle */
        .footer-kdo {
            background: var(--white);
            border-top: 1px solid var(--border-color);
            position: fixed;
            bottom: 0;
            width: 100%;
            padding: 8px 0;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        }
        
        .footer-nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        
        .footer-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--text-medium);
            transition: all 0.2s;
            padding: 4px;
            min-width: 60px;
            position: relative;
        }
        
        .footer-item:hover,
        .footer-item.active {
            color: var(--primary-orange);
            text-decoration: none;
        }
        
        .footer-icon {
            font-size: 18px;
            margin-bottom: 2px;
        }
        
        .footer-label {
            font-size: 10px;
            font-weight: 500;
        }
        
        /* Style pour le panier dans le footer */
        .cart-count-badge {
            position: absolute;
            top: 0;
            right: 5px;
            background: var(--primary-orange);
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: bold;
        }
        
        /* Alertes */
        .alert {
            border-radius: 6px;
            padding: 12px 15px;
            margin-bottom: 15px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .alert-warning {
            background: rgba(250, 173, 20, 0.1);
            border: 1px solid rgba(250, 173, 20, 0.3);
            color: var(--warning-yellow);
        }
        
        .alert-info {
            background: rgba(0, 102, 204, 0.1);
            border: 1px solid rgba(0, 102, 204, 0.3);
            color: var(--secondary-blue);
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .checkout-content {
                flex-direction: column;
            }
            
            .order-summary-sidebar {
                width: 100%;
            }
            
            .summary-card {
                position: static;
            }
        }
        
        @media (max-width: 768px) {
            .progress-steps {
                padding: 0 10px;
            }
            
            .step-label {
                font-size: 10px;
            }
            
            .step-icon {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }
            
            .progress-line {
                top: 16px;
                left: 40px;
                right: 40px;
            }
            
            .cart-item {
                flex-direction: column;
            }
            
            .cart-item-image {
                width: 100%;
                height: 150px;
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .cart-item-controls {
                flex-wrap: wrap;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
        
        @media (max-width: 576px) {
            .logo-text {
                display: none;
            }
            
            .search-wrapper {
                margin: 0 5px;
                max-width: 100%;
            }
            
            .progress-steps {
                overflow-x: auto;
                justify-content: flex-start;
                gap: 20px;
                padding-bottom: 5px;
            }
            
            .progress-step {
                min-width: 70px;
            }
            
            .progress-line {
                display: none;
            }
            
            .step-navigation {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn-prev, .btn-next, .btn-confirm {
                width: 100%;
                justify-content: center;
            }
            
            .footer-label {
                font-size: 9px;
            }
            
            .footer-icon {
                font-size: 16px;
            }
        }
        
        /* Pour les très petits écrans */
        @media (max-width: 360px) {
            .logo-text {
                display: none;
            }
            
            .footer-label {
                font-size: 8px;
            }
            
            .payment-header {
                flex-wrap: wrap;
            }
            
            .payment-desc {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Header simplifié -->
    <header class="header-kdo">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <!-- Logo -->
                <a href="dashboard.html" class="logo-container text-decoration-none">
                    <img src="https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/logos.png" 
                         alt="KDO CAMEROUN" 
                         class="logo-img">
                    <span class="logo-text">KDO CAMEROUN</span>
                </a>
                
                <!-- Barre de recherche -->
                <div class="search-wrapper">
                    <input type="text" class="search-input" placeholder="Rechercher produits, fournisseurs...">
                    <button class="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Contenu principal (initialement masqué jusqu'à authentification) -->
    <div id="mainContent" style="display: none;">
        <!-- Barre de progression du paiement -->
        <div class="checkout-progress">
            <div class="container">
                <div class="progress-steps">
                    <div class="progress-line">
                        <div class="progress-line-filled" id="progressFill"></div>
                    </div>
                    
                    <div class="progress-step active" id="step1">
                        <div class="step-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="step-label">Panier</div>
                    </div>
                    
                    <div class="progress-step" id="step2">
                        <div class="step-icon">
                            <i class="fas fa-truck"></i>
                        </div>
                        <div class="step-label">Livraison</div>
                    </div>
                    
                    <div class="progress-step" id="step3">
                        <div class="step-icon">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <div class="step-label">Paiement</div>
                    </div>
                    
                    <div class="progress-step" id="step4">
                        <div class="step-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="step-label">Confirmation</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contenu du panier -->
        <div class="container checkout-container">
            <div class="checkout-content">
                <!-- Étapes du paiement (colonne gauche) -->
                <div class="checkout-steps">
                    <!-- Étape 1: Panier -->
                    <div class="checkout-step active" id="checkoutStep1">
                        <div class="step-header">
                            <h3 class="step-title">
                                <span class="step-number">1</span>
                                Votre Panier
                            </h3>
                            <div class="text-muted" style="font-size: 13px;">
                                <span id="cartItemsCount">0</span> article(s)
                            </div>
                        </div>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            <div>Les prix et la disponibilité des produits sont confirmés lors de la commande.</div>
                        </div>
                        
                        <div class="cart-items-container" id="cartItemsContainer">
                            <!-- Articles chargés dynamiquement -->
                        </div>
                        
                        <div class="cart-empty" id="cartEmpty" style="display: none;">
                            <div class="cart-empty-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h3 class="cart-empty-title">Votre panier est vide</h3>
                            <p class="cart-empty-text">Ajoutez des produits à votre panier pour les acheter ou les comparer avec d'autres fournisseurs.</p>
                            <a href="dashboard.html" class="cart-empty-btn">
                                <i class="fas fa-shopping-bag"></i> Découvrir nos produits
                            </a>
                        </div>
                        
                        <div class="step-navigation">
                            <div></div> <!-- Espace vide à gauche -->
                            <button class="btn-next" id="btnToStep2" disabled>
                                Continuer vers la livraison
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Étape 2: Livraison -->
                    <div class="checkout-step" id="checkoutStep2">
                        <div class="step-header">
                            <h3 class="step-title">
                                <span class="step-number">2</span>
                                Informations de Livraison
                            </h3>
                        </div>
                        
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-circle"></i>
                            <div>La livraison est disponible uniquement dans les villes ci-dessous. Les délais commencent à partir de la confirmation de paiement.</div>
                        </div>
                        
                        <div class="delivery-options">
                            <h4 style="font-size: 14px; margin-bottom: 15px; color: var(--text-dark);">Options de livraison</h4>
                            
                            <div class="delivery-option selected" data-type="express">
                                <div class="delivery-header">
                                    <div class="delivery-icon">
                                        <i class="fas fa-bolt"></i>
                                    </div>
                                    <h5 class="delivery-title">Livraison Express</h5>
                                    <div class="delivery-price">À partir de 5 000 FCFA</div>
                                </div>
                                <p class="delivery-desc">Livraison rapide à domicile ou au point relai. Délai estimé: 1-3 jours ouvrables.</p>
                                <div class="delivery-time">
                                    <i class="fas fa-clock"></i>
                                    Livraison en 24-72h
                                </div>
                            </div>
                            
                            <div class="delivery-option" data-type="standard">
                                <div class="delivery-header">
                                    <div class="delivery-icon">
                                        <i class="fas fa-truck"></i>
                                    </div>
                                    <h5 class="delivery-title">Livraison Standard</h5>
                                    <div class="delivery-price">À partir de 1 000 FCFA</div>
                                </div>
                                <p class="delivery-desc">Livraison économique avec suivi. Délai estimé: 3-7 jours ouvrables.</p>
                                <div class="delivery-time">
                                    <i class="fas fa-clock"></i>
                                    Livraison en 3-7 jours
                                </div>
                            </div>
                            
                            <div class="delivery-option" data-type="pickup">
                                <div class="delivery-header">
                                    <div class="delivery-icon">
                                        <i class="fas fa-store"></i>
                                    </div>
                                    <h5 class="delivery-title">Retrait en magasin</h5>
                                    <div class="delivery-price">GRATUIT</div>
                                </div>
                                <p class="delivery-desc">Retirez votre commande dans l'un de nos points de vente. Présentez votre numéro de commande.</p>
                                <div class="delivery-time">
                                    <i class="fas fa-clock"></i>
                                    Prêt en 24h
                                </div>
                            </div>
                        </div>
                        
                        <div class="address-form">
                            <h4 style="font-size: 14px; margin-bottom: 15px; color: var(--text-dark);">Informations de contact et d'adresse</h4>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Nom complet *</label>
                                    <input type="text" class="form-control" id="deliveryName" placeholder="Votre nom complet" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Nom de l'entreprise (optionnel)</label>
                                    <input type="text" class="form-control" id="deliveryCompany" placeholder="Nom de votre entreprise">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Téléphone *</label>
                                    <input type="tel" class="form-control" id="deliveryPhone" placeholder="Ex: 6XX XXX XXX" required>
                                    <div class="form-hint">Pour vous contacter pour la livraison</div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Email *</label>
                                    <input type="email" class="form-control" id="deliveryEmail" placeholder="votre@email.com" required>
                                    <div class="form-hint">Pour recevoir les confirmations par email</div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Ville *</label>
                                    <select class="form-select" id="deliveryCity" required>
                                        <option value="">Sélectionnez votre ville</option>
                                        <option value="yaounde">Yaoundé</option>
                                        <option value="douala">Douala</option>
                                        <option value="bafoussam">Bafoussam</option>
                                        <option value="bertoua">Bertoua</option>
                                        <option value="maroua">Maroua</option>
                                        <option value="garoua">Garoua</option>
                                        <option value="ngaoundere">Ngaoundéré</option>
                                        <option value="ebolowa">Ebolowa</option>
                                        <option value="buea">Buéa</option>
                                        <option value="dchang">Dchang</option>
                                    </select>
                                    <div class="form-hint">Nous livrons uniquement dans ces villes</div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Quartier *</label>
                                    <input type="text" class="form-control" id="deliveryDistrict" placeholder="Ex: Bastos, Bonapriso, etc." required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Adresse complète *</label>
                                <textarea class="form-control form-textarea" id="deliveryAddress" placeholder="Numéro de maison, rue, immeuble, repères..." required></textarea>
                                <div class="form-hint">Donnez le maximum de détails pour faciliter la livraison</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Instructions spéciales (optionnel)</label>
                                <textarea class="form-control form-textarea" id="deliveryInstructions" placeholder="Ex: Appeler avant de livrer, laisser chez le gardien, etc."></textarea>
                            </div>
                            
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="setAsDefaultAddress">
                                <label class="form-check-label" for="setAsDefaultAddress">
                                    Définir cette adresse comme mon adresse par défaut pour toutes mes futures commandes
                                </label>
                            </div>
                            
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="saveContactInfo" checked>
                                <label class="form-check-label" for="saveContactInfo">
                                    Enregistrer mes informations de contact pour mes prochaines commandes
                                </label>
                            </div>
                        </div>
                        
                        <div class="step-navigation">
                            <button class="btn-prev" id="btnToStep1">
                                <i class="fas fa-arrow-left"></i>
                                Retour au panier
                            </button>
                            <button class="btn-next" id="btnToStep3" disabled>
                                Continuer vers le paiement
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Étape 3: Paiement -->
                    <div class="checkout-step" id="checkoutStep3">
                        <div class="step-header">
                            <h3 class="step-title">
                                <span class="step-number">3</span>
                                Paiement
                            </h3>
                        </div>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-lock"></i>
                            <div>Toutes les transactions sont sécurisées et cryptées. Vos informations de paiement ne sont jamais stockées sur nos serveurs.</div>
                        </div>
                        
                        <div class="payment-options">
                            <h4 style="font-size: 14px; margin-bottom: 15px; color: var(--text-dark);">Méthode de paiement</h4>
                            
                            <div class="payment-option selected" data-method="mobile_money">
                                <div class="payment-header">
                                    <div class="payment-icon orange">
                                        <i class="fas fa-mobile-alt"></i>
                                    </div>
                                    <h5 class="payment-title">Mobile Money</h5>
                                </div>
                                <p class="payment-desc">Orange Money, MTN Mobile Money, Express Union Mobile. Paiement instantané et sécurisé.</p>
                                <div class="payment-security">
                                    <div class="security-badge">
                                        <i class="fas fa-shield-alt"></i>
                                        Paiement sécurisé
                                    </div>
                                    <div class="security-badge">
                                        <i class="fas fa-bolt"></i>
                                        Instantané
                                    </div>
                                </div>
                            </div>
                            
                            <div class="payment-option" data-method="card">
                                <div class="payment-header">
                                    <div class="payment-icon blue">
                                        <i class="far fa-credit-card"></i>
                                    </div>
                                    <h5 class="payment-title">Carte bancaire</h5>
                                </div>
                                <p class="payment-desc">Visa, Mastercard, UnionPay. Paiement sécurisé via notre partenaire de paiement.</p>
                                <div class="payment-security">
                                    <div class="security-badge">
                                        <i class="fas fa-shield-alt"></i>
                                        SSL 256-bit
                                    </div>
                                    <div class="security-badge">
                                        <i class="fas fa-globe"></i>
                                        International
                                    </div>
                                </div>
                            </div>
                            
                            <div class="payment-option" data-method="bank">
                                <div class="payment-header">
                                    <div class="payment-icon green">
                                        <i class="fas fa-university"></i>
                                    </div>
                                    <h5 class="payment-title">Virement bancaire</h5>
                                </div>
                                <p class="payment-desc">Transfert bancaire vers notre compte. La commande est traitée après réception des fonds.</p>
                                <div class="payment-security">
                                    <div class="security-badge">
                                        <i class="fas fa-file-invoice"></i>
                                        Reçu fourni
                                    </div>
                                </div>
                            </div>
                            
                            <div class="payment-option" data-method="cash">
                                <div class="payment-header">
                                    <div class="payment-icon purple">
                                        <i class="fas fa-money-bill-wave"></i>
                                    </div>
                                    <h5 class="payment-title">Paiement à la livraison</h5>
                                </div>
                                <p class="payment-desc">Payez en espèces lors de la réception. Disponible uniquement pour Yaoundé et Douala.</p>
                                <div class="payment-security">
                                    <div class="security-badge">
                                        <i class="fas fa-hand-holding-usd"></i>
                                        Payez à réception
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="payment-info">
                            <h5 class="payment-info-title">
                                <i class="fas fa-info-circle"></i>
                                Informations importantes
                            </h5>
                            <p class="payment-info-text">
                                • Les commandes sont traitées dans les 24h suivant la confirmation de paiement.<br>
                                • Vous recevrez un SMS de confirmation avec votre numéro de suivi.<br>
                                • Pour les paiements par Mobile Money, utilisez le numéro affiché à l'étape suivante.<br>
                                • Les virements bancaires peuvent prendre 1-2 jours ouvrables pour être confirmés.
                            </p>
                        </div>
                        
                        <div class="terms-checkbox">
                            <input type="checkbox" id="acceptTerms" required>
                            <label class="terms-label">
                                J'accepte les <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">conditions générales de vente</a> et la <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">politique de confidentialité</a>. Je confirme que j'ai lu et compris les informations concernant ma commande.
                            </label>
                        </div>
                        
                        <div class="step-navigation">
                            <button class="btn-prev" id="btnToStep2">
                                <i class="fas fa-arrow-left"></i>
                                Retour à la livraison
                            </button>
                            <button class="btn-next" id="btnToStep4" disabled>
                                Confirmer la commande
                                <i class="fas fa-check-circle"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Étape 4: Confirmation -->
                    <div class="checkout-step" id="checkoutStep4">
                        <div class="step-header">
                            <h3 class="step-title">
                                <span class="step-number">4</span>
                                Confirmation
                            </h3>
                        </div>
                        
                        <div class="order-summary-section">
                            <div class="summary-section">
                                <h5 class="summary-section-title">
                                    <i class="fas fa-box"></i>
                                    Articles commandés
                                </h5>
                                <div id="confirmationItems">
                                    <!-- Articles chargés dynamiquement -->
                                </div>
                            </div>
                            
                            <div class="summary-section">
                                <h5 class="summary-section-title">
                                    <i class="fas fa-truck"></i>
                                    Livraison
                                </h5>
                                <div id="confirmationDelivery">
                                    <!-- Détails de livraison chargés dynamiquement -->
                                </div>
                            </div>
                            
                            <div class="summary-section">
                                <h5 class="summary-section-title">
                                    <i class="fas fa-credit-card"></i>
                                    Paiement
                                </h5>
                                <div id="confirmationPayment">
                                    <!-- Détails de paiement chargés dynamiquement -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="address-display" id="confirmationAddress">
                            <!-- Adresse chargée dynamiquement -->
                        </div>
                        
                        <div class="terms-checkbox">
                            <input type="checkbox" id="finalConfirmation" required>
                            <label class="terms-label">
                                Je confirme que toutes les informations ci-dessus sont correctes. Je comprends que toute modification après confirmation peut entraîner des frais supplémentaires ou l'annulation de la commande.
                            </label>
                        </div>
                        
                        <div class="step-navigation">
                            <button class="btn-prev" id="btnToStep3">
                                <i class="fas fa-arrow-left"></i>
                                Retour au paiement
                            </button>
                            <button class="btn-confirm" id="btnConfirmOrder" disabled>
                                <i class="fas fa-lock"></i>
                                Finaliser et payer
                            </button>
                        </div>
                    </div>
                    
                    <!-- Étape 5: Succès -->
                    <div class="checkout-step" id="checkoutStep5" style="display: none;">
                        <div class="order-success">
                            <div class="success-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h2 class="success-title">Commande confirmée !</h2>
                            <p class="success-subtitle">Merci pour votre commande sur KDO CAMEROUN</p>
                            <p class="success-message">
                                Votre commande a été enregistrée avec succès. Vous recevrez sous peu un email et un SMS de confirmation avec les détails de votre commande et les instructions de suivi.
                            </p>
                            
                            <div class="order-details">
                                <div class="order-id">
                                    Numéro de commande
                                    <span id="orderNumber">CMD-000000</span>
                                </div>
                                
                                <div class="summary-item">
                                    <span class="summary-label">Date de commande:</span>
                                    <span class="summary-value" id="orderDate">--/--/----</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">Montant total:</span>
                                    <span class="summary-value" id="orderTotal">0 FCFA</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">Mode de paiement:</span>
                                    <span class="summary-value" id="orderPayment">--</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">Statut:</span>
                                    <span class="summary-value" style="color: var(--success-green); font-weight: 600;">Confirmée</span>
                                </div>
                            </div>
                            
                            <div class="order-timeline">
                                <div class="timeline-item">
                                    <div class="timeline-icon">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">Commande confirmée</div>
                                        <p class="timeline-desc">Votre commande a été reçue et est en cours de traitement</p>
                                    </div>
                                </div>
                                
                                <div class="timeline-item">
                                    <div class="timeline-icon">
                                        <i class="fas fa-box"></i>
                                    </div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">Préparation</div>
                                        <p class="timeline-desc">Vos articles sont en cours de préparation par nos fournisseurs</p>
                                    </div>
                                </div>
                                
                                <div class="timeline-item">
                                    <div class="timeline-icon">
                                        <i class="fas fa-shipping-fast"></i>
                                    </div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">Expédition</div>
                                        <p class="timeline-desc">Votre colis sera expédié dans les 24h</p>
                                    </div>
                                </div>
                                
                                <div class="timeline-item">
                                    <div class="timeline-icon">
                                        <i class="fas fa-home"></i>
                                    </div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">Livraison</div>
                                        <p class="timeline-desc">Livraison estimée: <span id="deliveryEstimate">--/--/----</span></p>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
                                <a href="dashboard.html" class="btn-prev" style="text-decoration: none;">
                                    <i class="fas fa-shopping-bag"></i>
                                    Continuer mes achats
                                </a>
                                <button class="btn-next" id="btnTrackOrder">
                                    <i class="fas fa-map-marker-alt"></i>
                                    Suivre ma commande
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Résumé de la commande (colonne droite) -->
                <div class="order-summary-sidebar">
                    <div class="summary-card">
                        <div class="summary-header">
                            <h3 class="summary-title">
                                <i class="fas fa-receipt"></i>
                                Récapitulatif
                            </h3>
                        </div>
                        
                        <div class="summary-body">
                            <div class="summary-row">
                                <span class="label">Sous-total</span>
                                <span class="value" id="summarySubtotal">0 FCFA</span>
                            </div>
                            
                            <div class="summary-row savings" id="summarySavings" style="display: none;">
                                <span class="label">Économies</span>
                                <span class="value">-0 FCFA</span>
                            </div>
                            
                            <div class="summary-row delivery">
                                <span class="label">Livraison</span>
                                <span class="value" id="summaryShipping">0 FCFA</span>
                            </div>
                            
                            <div class="summary-row taxes">
                                <span class="label">Taxes & Frais</span>
                                <span class="value" id="summaryTaxes">500 FCFA</span>
                            </div>
                            
                            <div class="summary-row total">
                                <span class="label">Total</span>
                                <span class="value" id="summaryTotal">0 FCFA</span>
                            </div>
                            
                            <div class="summary-discount">
                                <div class="discount-title">
                                    <i class="fas fa-tag"></i>
                                    Code promotionnel
                                </div>
                                <div class="discount-input-group">
                                    <input type="text" class="discount-input" id="discountCode" placeholder="Entrez votre code">
                                    <button class="discount-btn" id="applyDiscount">Appliquer</button>
                                </div>
                                <div id="discountMessage" style="font-size: 11px; margin-top: 8px;"></div>
                            </div>
                            
                            <div style="margin-top: 20px; font-size: 11px; color: var(--text-light); text-align: center;">
                                <i class="fas fa-shield-alt"></i>
                                Paiement 100% sécurisé
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 15px; background: var(--accent-gray); border-radius: 8px; font-size: 11px; color: var(--text-medium);">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                            <i class="fas fa-info-circle" style="color: var(--secondary-blue);"></i>
                            <strong>Informations importantes</strong>
                        </div>
                        <p style="margin: 0; line-height: 1.4;">
                            • Les prix peuvent changer selon la disponibilité des fournisseurs<br>
                            • Vous pouvez modifier votre commande avant le paiement<br>
                            • Contactez-nous pour toute question: <strong>support@kdo-cameroun.com</strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page de connexion (affichée si utilisateur non connecté) -->
    <div id="loginContent" class="login-container">
        <h2 class="login-title">Connexion requise</h2>
        <p class="text-center mb-4">Vous devez être connecté pour accéder à votre panier et passer commande.</p>
        
        <div class="alert alert-info">
            <i class="fas fa-info-circle"></i>
            <div>Connectez-vous avec votre compte KDO CAMEROUN pour continuer.</div>
        </div>
        
        <div class="form-group mb-3">
            <label class="form-label">Email</label>
            <input type="email" class="form-control" id="loginEmail" placeholder="votre@email.com" required>
        </div>
        
        <div class="form-group mb-3">
            <label class="form-label">Mot de passe</label>
            <input type="password" class="form-control" id="loginPassword" placeholder="Votre mot de passe" required>
        </div>
        
        <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="rememberMe">
            <label class="form-check-label" for="rememberMe">
                Se souvenir de moi
            </label>
        </div>
        
        <button class="login-btn" id="loginBtn">
            <i class="fas fa-sign-in-alt me-2"></i>
            Se connecter
        </button>
        
        <div class="login-links">
            <p class="mb-2">
                <a href="register.html">Créer un compte</a>
            </p>
            <p class="mb-0">
                <a href="forgot-password.html">Mot de passe oublié ?</a>
            </p>
        </div>
    </div>

    <!-- Footer avec navigation fonctionnelle -->
    <footer class="footer-kdo">
        <div class="container">
            <nav class="footer-nav">
                <a href="dashboard.html" class="footer-item">
                    <i class="fas fa-home footer-icon"></i>
                    <span class="footer-label">Accueil</span>
                </a>
                <a href="promotion.html" class="footer-item">
                    <i class="fas fa-tag footer-icon"></i>
                    <span class="footer-label">Promotion</span>
                </a>
                <a href="boutique.html" class="footer-item">
                    <i class="fas fa-store footer-icon"></i>
                    <span class="footer-label">Boutique</span>
                </a>
                <a href="panier.html" class="footer-item active">
                    <i class="fas fa-shopping-cart footer-icon"></i>
                    <span class="footer-label">Panier</span>
                    <span id="footerCartCount" class="cart-count-badge">0</span>
                </a>
                <a href="profil.html" class="footer-item">
                    <i class="far fa-user footer-icon"></i>
                    <span class="footer-label">Mon KDO</span>
                </a>
            </nav>
        </div>
    </footer>

    <!-- Modals pour les conditions -->
    <div class="modal fade" id="termsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Conditions générales de vente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="font-size: 12px; line-height: 1.6;">
                    <p><strong>Article 1 : Objet</strong><br>
                    Les présentes conditions régissent les ventes par la société KDO CAMEROUN.</p>
                    
                    <p><strong>Article 2 : Prix</strong><br>
                    Les prix sont indiqués en francs CFA et sont susceptibles de modification.</p>
                    
                    <p><strong>Article 3 : Commande</strong><br>
                    Vous pouvez passer commande directement sur notre site. Toute commande vaut acceptation des prix et descriptions des produits disponibles à la vente.</p>
                    
                    <p><strong>Article 4 : Validation de votre commande</strong><br>
                    Toute commande figurant sur le site Internet suppose l'adhésion aux présentes Conditions Générales.</p>
                    
                    <p><strong>Article 5 : Paiement</strong><br>
                    Le paiement est exigible immédiatement à la commande, y compris pour les produits en précommande.</p>
                    
                    <p><strong>Article 6 : Livraison</strong><br>
                    Les produits sont livrés à l'adresse indiquée par le client sur le bon de commande.</p>
                    
                    <p><strong>Article 7 : Droit de rétractation</strong><br>
                    Conformément à la loi, vous disposez d'un délai de 7 jours pour exercer votre droit de rétractation sans avoir à justifier de motifs.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="privacyModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Politique de confidentialité</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="font-size: 12px; line-height: 1.6;">
                    <p><strong>Protection de vos données personnelles</strong><br>
                    KDO CAMEROUN s'engage à protéger la confidentialité de vos données personnelles.</p>
                    
                    <p><strong>Collecte des données</strong><br>
                    Nous collectons les informations que vous nous fournissez lors de votre inscription, de votre commande ou de votre navigation.</p>
                    
                    <p><strong>Utilisation des données</strong><br>
                    Vos données sont utilisées pour traiter vos commandes, vous informer sur l'état de vos commandes, et vous proposer des services personnalisés.</p>
                    
                    <p><strong>Partage des données</strong><br>
                    Nous ne vendons pas vos données personnelles. Elles peuvent être partagées avec nos prestataires pour la livraison et le paiement.</p>
                    
                    <p><strong>Sécurité</strong><br>
                    Nous mettons en œuvre des mesures de sécurité pour protéger vos données contre tout accès non autorisé.</p>
                    
                    <p><strong>Vos droits</strong><br>
                    Vous disposez d'un droit d'accès, de rectification et de suppression de vos données personnelles.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"></script>

    <!-- Bootstrap & jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Script principal -->
    <script>
        // Nouvelle configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAYcjkrXKcjqFnf8E91JZWU1lMGS-yxSOU",
            authDomain: "kdo-cameroun.firebaseapp.com",
            projectId: "kdo-cameroun",
            storageBucket: "kdo-cameroun.firebasestorage.app",
            messagingSenderId: "445876564547",
            appId: "1:445876564547:web:26507d61bb091fa7bd1af6",
            measurementId: "G-FX2DVSKLKZ"
        };

        // Initialiser Firebase
        let firebaseApp, firebaseDb, firebaseAuth;
        let currentUser = null;
        let userCart = { items: {}, totalItems: 0, totalAmount: 0 };
        let userProfile = null;
        let userAddresses = [];
        let defaultAddress = null;
        let currentStep = 1;
        let deliveryOption = 'express';
        let paymentMethod = 'mobile_money';
        let deliveryInfo = {};
        let orderDetails = {};
        let appliedDiscount = null;
        let allProducts = [];

        // Formatage des prix
        function formatPrice(price) {
            return new Intl.NumberFormat('fr-FR').format(price) + " FCFA";
        }

        // Obtenir l'URL de l'image d'un produit
        function getProductImageUrl(product) {
            const categoryImages = {
                ordinateur: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/Ordinateur/1.jpg",
                disquedur: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/disque.png",
                usb: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/cle.png",
                souris: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/souris.jpg",
                clavier: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/clavier.jpeg",
                modem: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/modems.jpeg",
                desktop: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/desktops.jpeg",
                ram: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/RAM.png",
                antivirus: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/virus.png",
                videoprojecteur: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/projeteur.jpg",
                telephone: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/phone.jpeg",
                adaptateur: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/adaptateur.jpeg",
                television: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/t%C3%A9l%C3%A9vision.jpg",
                chargeur: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/chargeur.png",
                sac: "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/sacs.png"
            };
            
            return categoryImages[product.category] || "https://raw.githubusercontent.com/exaucenapopolo/KDO-SHOP/refs/heads/main/Photo/89_1.jpg";
        }

        // Initialiser Firebase et vérifier l'authentification
        async function initializeFirebase() {
            try {
                if (typeof firebase === 'undefined') {
                    console.error("Firebase n'est pas chargé");
                    showLoginPage();
                    return;
                }
                
                // Initialiser Firebase
                if (!firebase.apps.length) {
                    firebaseApp = firebase.initializeApp(firebaseConfig);
                } else {
                    firebaseApp = firebase.app();
                }
                
                firebaseAuth = firebase.auth();
                firebaseDb = firebase.firestore();
                
                // Vérifier l'état d'authentification
                firebaseAuth.onAuthStateChanged(async (user) => {
                    if (user) {
                        // Utilisateur connecté
                        currentUser = user;
                        console.log("Utilisateur connecté:", currentUser.uid, currentUser.email);
                        
                        // Charger le profil utilisateur
                        await loadUserProfile();
                        
                        // Charger le panier
                        await loadCartFromFirestore();
                        
                        // Charger les adresses
                        await loadUserAddresses();
                        
                        // Charger les produits
                        await loadAllProducts();
                        
                        // Afficher le panier
                        showCartPage();
                        
                        // Mettre à jour l'affichage
                        updateCartDisplay();
                        updateSummary();
                        
                    } else {
                        // Utilisateur non connecté
                        console.log("Utilisateur non connecté");
                        showLoginPage();
                    }
                });
                
            } catch (error) {
                console.error("Erreur Firebase:", error);
                showLoginPage();
            }
        }

        // Afficher la page de connexion
        function showLoginPage() {
            $('#loginContent').show();
            $('#mainContent').hide();
            $('.footer-kdo').show();
        }

        // Afficher la page du panier
        function showCartPage() {
            $('#loginContent').hide();
            $('#mainContent').show();
            $('.footer-kdo').show();
        }

        // Connexion de l'utilisateur
        async function loginUser(email, password) {
            try {
                const userCredential = await firebaseAuth.signInWithEmailAndPassword(email, password);
                currentUser = userCredential.user;
                console.log("Connexion réussie:", currentUser.email);
                
                // Charger les données utilisateur
                await loadUserProfile();
                await loadCartFromFirestore();
                await loadUserAddresses();
                await loadAllProducts();
                
                showCartPage();
                updateCartDisplay();
                updateSummary();
                
                return true;
            } catch (error) {
                console.error("Erreur de connexion:", error);
                showLoginError(error.message);
                return false;
            }
        }

        // Afficher les erreurs de connexion
        function showLoginError(message) {
            let errorMessage = "Erreur de connexion";
            
            if (message.includes("user-not-found")) {
                errorMessage = "Aucun compte trouvé avec cet email";
            } else if (message.includes("wrong-password")) {
                errorMessage = "Mot de passe incorrect";
            } else if (message.includes("invalid-email")) {
                errorMessage = "Adresse email invalide";
            } else if (message.includes("too-many-requests")) {
                errorMessage = "Trop de tentatives échouées. Veuillez réessayer plus tard";
            }
            
            alert(errorMessage);
        }

        // Charger le profil utilisateur depuis Firestore
        async function loadUserProfile() {
            if (!currentUser) return;
            
            try {
                const userRef = firebaseDb.collection("users").doc(currentUser.uid);
                const userSnap = await userRef.get();
                
                if (userSnap.exists()) {
                    userProfile = userSnap.data();
                    console.log("Profil utilisateur chargé:", userProfile);
                    
                    // Préremplir le formulaire avec les informations du profil
                    if (userProfile.fullName) {
                        $('#deliveryName').val(userProfile.fullName);
                    }
                    if (userProfile.phone) {
                        $('#deliveryPhone').val(userProfile.phone);
                    }
                    if (userProfile.email) {
                        $('#deliveryEmail').val(userProfile.email);
                    }
                    if (userProfile.company) {
                        $('#deliveryCompany').val(userProfile.company);
                    }
                    
                } else {
                    console.log("Aucun profil trouvé pour cet utilisateur");
                    // Créer un profil de base si nécessaire
                    userProfile = {
                        uid: currentUser.uid,
                        email: currentUser.email,
                        createdAt: new Date().toISOString()
                    };
                }
            } catch (error) {
                console.error("Erreur lors du chargement du profil:", error);
            }
        }

        // Charger tous les produits depuis Firestore
        async function loadAllProducts() {
            try {
                const productsRef = firebaseDb.collection("products");
                const snapshot = await productsRef.get();
                
                allProducts = [];
                snapshot.forEach(doc => {
                    const product = { id: doc.id, ...doc.data() };
                    
                    // S'assurer que le produit a les champs nécessaires
                    if (!product.category) product.category = 'other';
                    if (!product.specs) product.specs = '';
                    
                    allProducts.push(product);
                });
                
                console.log("Produits chargés:", allProducts.length);
                
                // Si aucun produit, utiliser des données par défaut
                if (allProducts.length === 0) {
                    allProducts = getDefaultProducts();
                }
            } catch (error) {
                console.error("Erreur lors du chargement des produits:", error);
                allProducts = getDefaultProducts();
            }
        }

        // Données par défaut des produits
        function getDefaultProducts() {
            return [
                { id: "1", name: "DELL Latitude 3190", price: 65000, oldPrice: 80000, category: "ordinateur", specs: "Procésseur: INTEL CELERON, HDD: 128 Go, RAM: 8 Go" },
                { id: "2", name: "HP Elitebook 840 G3", price: 160000, oldPrice: 175000, category: "ordinateur", specs: "Procésseur: CORE I5, HDD: 256 Go, RAM: 8 Go" },
                { id: "39", name: "TOSHIBA Disque Dur", price: 15000, oldPrice: 18500, category: "disquedur", specs: "Taille: 500 Go" },
                { id: "66", name: "HP Souris USB", price: 5000, oldPrice: 6500, category: "souris", specs: "Type de souris: SANS FIL" }
            ];
        }

        // Charger le panier depuis Firestore
        async function loadCartFromFirestore() {
            if (!currentUser) {
                console.log("Pas d'utilisateur pour charger le panier");
                return;
            }
            
            try {
                const cartRef = firebaseDb.collection("carts").doc(currentUser.uid);
                const cartSnap = await cartRef.get();
                
                if (cartSnap.exists()) {
                    const cartData = cartSnap.data();
                    userCart = cartData;
                    console.log("Panier chargé depuis Firestore:", userCart);
                } else {
                    // Créer un nouveau panier vide
                    userCart = {
                        userId: currentUser.uid,
                        items: {},
                        totalItems: 0,
                        totalAmount: 0,
                        updatedAt: new Date().toISOString()
                    };
                    await cartRef.set(userCart);
                    console.log("Nouveau panier créé dans Firestore");
                }
                
            } catch (error) {
                console.error("Erreur lors du chargement du panier:", error);
                userCart = { items: {}, totalItems: 0, totalAmount: 0 };
            }
        }

        // Charger les adresses de l'utilisateur
        async function loadUserAddresses() {
            if (!currentUser) return;
            
            try {
                const addressesRef = firebaseDb.collection("userAddresses").where("userId", "==", currentUser.uid);
                const snapshot = await addressesRef.get();
                
                userAddresses = [];
                snapshot.forEach(doc => {
                    const address = { id: doc.id, ...doc.data() };
                    userAddresses.push(address);
                    
                    if (address.isDefault) {
                        defaultAddress = address;
                        // Préremplir le formulaire avec l'adresse par défaut
                        prefillAddressForm(address);
                    }
                });
                
                console.log("Adresses chargées:", userAddresses.length);
                
                // Si aucune adresse mais que l'utilisateur a un profil, utiliser ces informations
                if (userAddresses.length === 0 && userProfile) {
                    prefillWithProfileInfo();
                }
            } catch (error) {
                console.error("Erreur lors du chargement des adresses:", error);
                prefillWithProfileInfo();
            }
        }

        // Préremplir avec les informations du profil
        function prefillWithProfileInfo() {
            if (!userProfile) return;
            
            if (userProfile.fullName) {
                $('#deliveryName').val(userProfile.fullName);
            }
            if (userProfile.phone) {
                $('#deliveryPhone').val(userProfile.phone);
            }
            if (userProfile.email) {
                $('#deliveryEmail').val(userProfile.email);
            }
            if (userProfile.company) {
                $('#deliveryCompany').val(userProfile.company);
            }
        }

        // Préremplir le formulaire d'adresse
        function prefillAddressForm(address) {
            if (!address) return;
            
            $('#deliveryName').val(address.name || '');
            $('#deliveryCompany').val(address.company || '');
            $('#deliveryPhone').val(address.phone || '');
            $('#deliveryEmail').val(address.email || '');
            $('#deliveryCity').val(address.city || '');
            $('#deliveryDistrict').val(address.district || '');
            $('#deliveryAddress').val(address.address || '');
            $('#deliveryInstructions').val(address.instructions || '');
            
            if (address.isDefault) {
                $('#setAsDefaultAddress').prop('checked', true);
            }
        }

        // Sauvegarder l'adresse dans Firestore
        async function saveUserAddress(addressData, isDefault = false) {
            if (!currentUser) {
                return null;
            }
            
            try {
                const addressesRef = firebaseDb.collection("userAddresses");
                
                // Si c'est l'adresse par défaut, désactiver les autres adresses par défaut
                if (isDefault) {
                    // Mettre à jour toutes les autres adresses pour qu'elles ne soient plus par défaut
                    const batch = firebaseDb.batch();
                    
                    userAddresses.forEach(addr => {
                        if (addr.isDefault) {
                            const addrRef = addressesRef.doc(addr.id);
                            batch.update(addrRef, { isDefault: false });
                        }
                    });
                    
                    await batch.commit();
                }
                
                // Ajouter la nouvelle adresse
                const addressToSave = {
                    userId: currentUser.uid,
                    ...addressData,
                    isDefault: isDefault,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                const docRef = await addressesRef.add(addressToSave);
                console.log("Adresse sauvegardée dans Firestore:", docRef.id);
                
                // Mettre à jour la liste locale
                addressToSave.id = docRef.id;
                userAddresses.push(addressToSave);
                
                if (isDefault) {
                    defaultAddress = addressToSave;
                }
                
                return docRef.id;
            } catch (error) {
                console.error("Erreur lors de la sauvegarde de l'adresse:", error);
                return null;
            }
        }

        // Mettre à jour le panier dans Firestore
        async function updateCartInFirestore() {
            if (!currentUser) {
                return;
            }
            
            try {
                const cartRef = firebaseDb.collection("carts").doc(currentUser.uid);
                
                // Calculer les totaux
                let totalItems = 0;
                let totalAmount = 0;
                
                for (const productId in userCart.items) {
                    const item = userCart.items[productId];
                    totalItems += item.quantity;
                    totalAmount += item.price * item.quantity;
                }
                
                userCart.totalItems = totalItems;
                userCart.totalAmount = totalAmount;
                userCart.updatedAt = new Date().toISOString();
                
                await cartRef.set(userCart);
                console.log("Panier mis à jour dans Firestore");
                
            } catch (error) {
                console.error("Erreur lors de la mise à jour du panier:", error);
            }
        }

        // Mettre à jour l'affichage du panier
        function updateCartDisplay() {
            const container = $('#cartItemsContainer');
            const emptyCart = $('#cartEmpty');
            const btnToStep2 = $('#btnToStep2');
            
            // Calculer le nombre total d'articles
            const totalItems = Object.keys(userCart.items).length;
            
            if (totalItems === 0) {
                container.empty();
                emptyCart.show();
                btnToStep2.prop('disabled', true);
                $('#cartItemsCount').text('0');
                updateCartCount();
                return;
            }
            
            emptyCart.hide();
            container.empty();
            btnToStep2.prop('disabled', false);
            
            let itemsCount = 0;
            
            // Rendre chaque article du panier
            for (const productId in userCart.items) {
                const item = userCart.items[productId];
                const product = allProducts.find(p => p.id === productId) || item;
                const totalPrice = item.price * item.quantity;
                const imageUrl = getProductImageUrl(product);
                itemsCount += item.quantity;
                
                const cartItem = `
                    <div class="cart-item" data-id="${productId}">
                        <div class="cart-item-image">
                            <img src="${imageUrl}" alt="${product.name}" class="cart-item-img">
                        </div>
                        <div class="cart-item-details">
                            <div class="cart-item-header">
                                <div>
                                    <h4 class="cart-item-title">${product.name}</h4>
                                    <p class="cart-item-supplier">Fournisseur vérifié • En stock</p>
                                    <p style="font-size: 11px; color: var(--text-medium); margin: 3px 0 0;">${product.specs || ''}</p>
                                </div>
                                <div class="cart-item-price">
                                    ${formatPrice(totalPrice)}
                                    ${item.oldPrice ? `<span>${formatPrice(item.oldPrice * item.quantity)}</span>` : ''}
                                </div>
                            </div>
                            <div class="cart-item-controls">
                                <div class="quantity-control">
                                    <button class="quantity-btn minus" data-id="${productId}" ${item.quantity <= 1 ? 'disabled' : ''}>
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <input type="number" class="quantity-input" value="${item.quantity}" min="1" max="100" data-id="${productId}">
                                    <button class="quantity-btn plus" data-id="${productId}">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                                <button class="cart-item-remove" data-id="${productId}">
                                    <i class="fas fa-trash"></i> Supprimer
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.append(cartItem);
            }
            
            $('#cartItemsCount').text(itemsCount);
            updateCartCount();
        }

        // Mettre à jour le compteur du panier
        function updateCartCount() {
            let totalItems = 0;
            for (const productId in userCart.items) {
                totalItems += userCart.items[productId].quantity;
            }
            $('#footerCartCount').text(totalItems);
        }

        // Mettre à jour le récapitulatif
        function updateSummary() {
            let subtotal = 0;
            let savings = 0;
            let itemsCount = 0;
            
            // Calculer le sous-total et les économies
            for (const productId in userCart.items) {
                const item = userCart.items[productId];
                subtotal += item.price * item.quantity;
                itemsCount += item.quantity;
                
                if (item.oldPrice) {
                    savings += (item.oldPrice - item.price) * item.quantity;
                }
            }
            
            // Calculer les frais de livraison
            let shipping = 0;
            if (itemsCount > 0) {
                if (deliveryOption === 'express') {
                    shipping = 5000;
                } else if (deliveryOption === 'standard') {
                    shipping = 1000;
                } else if (deliveryOption === 'pickup') {
                    shipping = 0;
                }
            }
            
            // Taxes fixes
            const taxes = 500;
            
            // Appliquer une réduction si code promo
            let discount = 0;
            if (appliedDiscount) {
                if (appliedDiscount.type === 'percentage') {
                    discount = subtotal * (appliedDiscount.value / 100);
                } else if (appliedDiscount.type === 'fixed') {
                    discount = appliedDiscount.value;
                }
                discount = Math.min(discount, subtotal); // Ne peut pas dépasser le sous-total
            }
            
            // Calculer le total
            let total = subtotal - discount + shipping + taxes;
            if (total < 0) total = 0;
            
            // Mettre à jour l'affichage
            $('#summarySubtotal').text(formatPrice(subtotal));
            $('#summaryShipping').text(formatPrice(shipping));
            $('#summaryTaxes').text(formatPrice(taxes));
            $('#summaryTotal').text(formatPrice(total));
            
            if (savings > 0) {
                $('#summarySavings').show().find('.value').text('-' + formatPrice(savings));
            } else {
                $('#summarySavings').hide();
            }
            
            // Mettre à jour les informations de commande
            orderDetails = {
                subtotal,
                shipping,
                taxes,
                discount,
                total,
                itemsCount,
                savings
            };
            
            // Mettre à jour la confirmation
            updateConfirmation();
        }

        // Mettre à jour l'affichage de confirmation
        function updateConfirmation() {
            // Articles
            const confirmationItems = $('#confirmationItems');
            confirmationItems.empty();
            
            for (const productId in userCart.items) {
                const item = userCart.items[productId];
                const product = allProducts.find(p => p.id === productId) || item;
                const totalPrice = item.price * item.quantity;
                
                confirmationItems.append(`
                    <div class="summary-item">
                        <span class="summary-label">${product.name} (x${item.quantity})</span>
                        <span class="summary-value">${formatPrice(totalPrice)}</span>
                    </div>
                `);
            }
            
            // Livraison
            const deliveryText = deliveryOption === 'express' ? 'Livraison Express' : 
                                deliveryOption === 'standard' ? 'Livraison Standard' : 'Retrait en magasin';
            const deliveryPrice = deliveryOption === 'express' ? '5 000 FCFA' : 
                                 deliveryOption === 'standard' ? '1 000 FCFA' : 'GRATUIT';
            
            $('#confirmationDelivery').html(`
                <div class="summary-item">
                    <span class="summary-label">Type de livraison</span>
                    <span class="summary-value">${deliveryText}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Frais de livraison</span>
                    <span class="summary-value">${deliveryPrice}</span>
                </div>
            `);
            
            // Paiement
            const paymentText = paymentMethod === 'mobile_money' ? 'Mobile Money' :
                               paymentMethod === 'card' ? 'Carte bancaire' :
                               paymentMethod === 'bank' ? 'Virement bancaire' : 'Paiement à la livraison';
            
            $('#confirmationPayment').html(`
                <div class="summary-item">
                    <span class="summary-label">Méthode de paiement</span>
                    <span class="summary-value">${paymentText}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Statut</span>
                    <span class="summary-value" style="color: var(--warning-yellow);">En attente de paiement</span>
                </div>
            `);
            
            // Adresse (si remplie)
            if (deliveryInfo.name) {
                const cityNames = {
                    'yaounde': 'Yaoundé',
                    'douala': 'Douala',
                    'bafoussam': 'Bafoussam',
                    'bertoua': 'Bertoua',
                    'maroua': 'Maroua',
                    'garoua': 'Garoua',
                    'ngaoundere': 'Ngaoundéré',
                    'ebolowa': 'Ebolowa',
                    'buea': 'Buéa',
                    'dchang': 'Dchang'
                };
                
                let addressHTML = `<div class="address-name">${deliveryInfo.name || ''}`;
                
                if (deliveryInfo.company) {
                    addressHTML += ` (${deliveryInfo.company})`;
                }
                
                addressHTML += `</div>
                    <div class="address-details">
                        ${deliveryInfo.address || ''}<br>
                        ${deliveryInfo.district || ''}, ${cityNames[deliveryInfo.city] || deliveryInfo.city}
                    </div>
                    <div class="address-contact">
                        <span><i class="fas fa-phone"></i> ${deliveryInfo.phone || ''}</span>`;
                
                if (deliveryInfo.email) {
                    addressHTML += `<span><i class="fas fa-envelope"></i> ${deliveryInfo.email}</span>`;
                }
                
                addressHTML += `</div>`;
                
                $('#confirmationAddress').html(addressHTML);
            }
            
            // Mettre à jour le total de commande
            $('#orderTotal').text(formatPrice(orderDetails.total));
            $('#orderPayment').text(paymentText);
        }

        // Changer d'étape
        function goToStep(step) {
            // Masquer toutes les étapes
            $('.checkout-step').removeClass('active');
            
            // Désactiver toutes les étapes de progression
            $('.progress-step').removeClass('active completed');
            
            // Activer la nouvelle étape
            $(`#checkoutStep${step}`).addClass('active');
            
            // Mettre à jour la progression
            for (let i = 1; i <= step; i++) {
                $(`#step${i}`).addClass('completed');
            }
            $(`#step${step}`).addClass('active');
            
            // Mettre à jour la barre de progression
            const progress = ((step - 1) / 3) * 100;
            $('#progressFill').css('width', progress + '%');
            
            currentStep = step;
            
            // Mettre à jour les boutons de navigation
            updateNavigationButtons();
        }

        // Mettre à jour les boutons de navigation
        function updateNavigationButtons() {
            // Activer/désactiver les boutons suivant selon les conditions
            if (currentStep === 1) {
                // Étape 1: Panier - Activer si panier non vide
                const hasItems = Object.keys(userCart.items).length > 0;
                $('#btnToStep2').prop('disabled', !hasItems);
            } else if (currentStep === 2) {
                // Étape 2: Livraison - Activer si formulaire valide
                const isValid = validateDeliveryForm();
                $('#btnToStep3').prop('disabled', !isValid);
            } else if (currentStep === 3) {
                // Étape 3: Paiement - Activer si conditions acceptées
                const isAccepted = $('#acceptTerms').is(':checked');
                $('#btnToStep4').prop('disabled', !isAccepted);
            } else if (currentStep === 4) {
                // Étape 4: Confirmation - Activer si confirmation finale cochée
                const isConfirmed = $('#finalConfirmation').is(':checked');
                $('#btnConfirmOrder').prop('disabled', !isConfirmed);
            }
        }

        // Valider le formulaire de livraison
        function validateDeliveryForm() {
            const name = $('#deliveryName').val();
            const phone = $('#deliveryPhone').val();
            const email = $('#deliveryEmail').val();
            const city = $('#deliveryCity').val();
            const district = $('#deliveryDistrict').val();
            const address = $('#deliveryAddress').val();
            
            // Validation basique
            if (!name || !phone || !email || !city || !district || !address) {
                return false;
            }
            
            // Validation du téléphone (format camerounais simplifié)
            const phoneRegex = /^[2367][0-9]{8}$/;
            const cleanPhone = phone.replace(/\s/g, '');
            if (!phoneRegex.test(cleanPhone)) {
                return false;
            }
            
            // Validation de l'email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                return false;
            }
            
            // Sauvegarder les informations
            deliveryInfo = {
                name,
                company: $('#deliveryCompany').val(),
                phone: cleanPhone,
                email,
                city,
                district,
                address,
                instructions: $('#deliveryInstructions').val()
            };
            
            return true;
        }

        // Sauvegarder les informations d'adresse
        async function saveAddressInfo() {
            if (!validateDeliveryForm()) return false;
            
            const isDefault = $('#setAsDefaultAddress').is(':checked');
            const saveContact = $('#saveContactInfo').is(':checked');
            
            // Sauvegarder l'adresse
            await saveUserAddress(deliveryInfo, isDefault);
            
            // Mettre à jour le profil utilisateur si demandé
            if (saveContact) {
                await updateUserProfile();
            }
            
            return true;
        }

        // Mettre à jour le profil utilisateur
        async function updateUserProfile() {
            if (!currentUser) return;
            
            try {
                const userRef = firebaseDb.collection("users").doc(currentUser.uid);
                
                const updateData = {
                    fullName: deliveryInfo.name,
                    phone: deliveryInfo.phone,
                    email: deliveryInfo.email,
                    company: deliveryInfo.company || '',
                    updatedAt: new Date().toISOString()
                };
                
                await userRef.set(updateData, { merge: true });
                console.log("Profil utilisateur mis à jour");
            } catch (error) {
                console.error("Erreur lors de la mise à jour du profil:", error);
            }
        }

        // Appliquer un code promo
        function applyDiscountCode(code) {
            // Codes promotionnels
            const discountCodes = {
                'KDO10': { type: 'percentage', value: 10, minOrder: 50000 },
                'KDO5000': { type: 'fixed', value: 5000, minOrder: 100000 },
                'BIENVENUE': { type: 'percentage', value: 15, minOrder: 0 },
                'LIVRAISON': { type: 'fixed', value: 1000, minOrder: 50000 }
            };
            
            const discount = discountCodes[code.toUpperCase()];
            
            if (discount) {
                if (orderDetails.subtotal >= discount.minOrder) {
                    appliedDiscount = discount;
                    $('#discountMessage').html(`<span style="color: var(--success-green);">Code appliqué ! Réduction de ${discount.type === 'percentage' ? discount.value + '%' : formatPrice(discount.value)}</span>`);
                    updateSummary();
                    return true;
                } else {
                    $('#discountMessage').html(`<span style="color: var(--danger-red);">Commande minimum de ${formatPrice(discount.minOrder)} requise</span>`);
                    return false;
                }
            } else {
                $('#discountMessage').html(`<span style="color: var(--danger-red);">Code invalide</span>`);
                return false;
            }
        }

        // Finaliser la commande
        async function finalizeOrder() {
            // Sauvegarder l'adresse d'abord
            const addressSaved = await saveAddressInfo();
            if (!addressSaved) {
                alert("Veuillez vérifier vos informations d'adresse.");
                return;
            }
            
            // Générer un numéro de commande
            const orderNumber = 'CMD-' + Date.now().toString().slice(-8);
            
            // Calculer la date de livraison estimée
            const today = new Date();
            const deliveryDays = deliveryOption === 'express' ? 3 : 7;
            const deliveryDate = new Date(today);
            deliveryDate.setDate(deliveryDate.getDate() + deliveryDays);
            
            const formattedDate = deliveryDate.toLocaleDateString('fr-FR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
            
            // Sauvegarder la commande dans Firestore
            if (currentUser) {
                try {
                    const orderRef = firebaseDb.collection("orders").doc();
                    const orderData = {
                        orderId: orderNumber,
                        userId: currentUser.uid,
                        userEmail: currentUser.email,
                        items: userCart.items,
                        delivery: deliveryInfo,
                        deliveryOption: deliveryOption,
                        paymentMethod: paymentMethod,
                        summary: orderDetails,
                        discount: appliedDiscount,
                        status: 'confirmed',
                        createdAt: new Date().toISOString(),
                        estimatedDelivery: deliveryDate.toISOString(),
                        paymentStatus: 'pending',
                        addressId: defaultAddress ? defaultAddress.id : null
                    };
                    
                    await orderRef.set(orderData);
                    console.log("Commande sauvegardée dans Firestore:", orderNumber);
                    
                    // Vider le panier après commande
                    userCart.items = {};
                    await updateCartInFirestore();
                    
                } catch (error) {
                    console.error("Erreur lors de la sauvegarde de la commande:", error);
                    alert("Erreur lors de l'enregistrement de la commande. Veuillez réessayer.");
                    return;
                }
            }
            
            // Mettre à jour l'affichage de succès
            $('#orderNumber').text(orderNumber);
            $('#orderDate').text(today.toLocaleDateString('fr-FR'));
            $('#orderTotal').text(formatPrice(orderDetails.total));
            
            const paymentText = paymentMethod === 'mobile_money' ? 'Mobile Money' :
                               paymentMethod === 'card' ? 'Carte bancaire' :
                               paymentMethod === 'bank' ? 'Virement bancaire' : 'Paiement à la livraison';
            $('#orderPayment').text(paymentText);
            $('#deliveryEstimate').text(formattedDate);
            
            // Passer à l'étape de succès
            goToStep(5);
            
            // Afficher les instructions de paiement selon la méthode
            let paymentInstructions = '';
            
            if (paymentMethod === 'mobile_money') {
                paymentInstructions = `
                    <div style="background: #F0F9FF; border-radius: 8px; padding: 15px; margin: 20px 0; border-left: 4px solid var(--secondary-blue);">
                        <h6 style="color: var(--secondary-blue); margin-bottom: 10px;">
                            <i class="fas fa-mobile-alt"></i> Instructions de paiement Mobile Money
                        </h6>
                        <p style="margin: 0; font-size: 12px; color: var(--text-dark);">
                            1. Accédez à votre service Mobile Money (Orange Money, MTN Mobile Money)<br>
                            2. Effectuez un transfert vers le numéro: <strong>6XX XXX XXX</strong><br>
                            3. Montant: <strong>${formatPrice(orderDetails.total)}</strong><br>
                            4. Référence: <strong>${orderNumber}</strong><br>
                            5. Envoyez le reçu à <strong>paiement@kdo-cameroun.com</strong>
                        </p>
                    </div>
                `;
            } else if (paymentMethod === 'bank') {
                paymentInstructions = `
                    <div style="background: #F0F9FF; border-radius: 8px; padding: 15px; margin: 20px 0; border-left: 4px solid var(--secondary-blue);">
                        <h6 style="color: var(--secondary-blue); margin-bottom: 10px;">
                            <i class="fas fa-university"></i> Instructions de virement bancaire
                        </h6>
                        <p style="margin: 0; font-size: 12px; color: var(--text-dark);">
                            <strong>Banque:</strong> Afriland First Bank<br>
                            <strong>Titulaire:</strong> KDO CAMEROUN SARL<br>
                            <strong>Numéro de compte:</strong> 12345678901<br>
                            <strong>Montant:</strong> ${formatPrice(orderDetails.total)}<br>
                            <strong>Référence:</strong> ${orderNumber}<br>
                            Envoyez le reçu de virement à <strong>paiement@kdo-cameroun.com</strong>
                        </p>
                    </div>
                `;
            }
            
            if (paymentInstructions) {
                $('.order-success .success-message').after(paymentInstructions);
            }
        }

        // Initialisation
        $(document).ready(async function() {
            // Initialiser Firebase
            await initializeFirebase();
            
            // Connexion
            $('#loginBtn').on('click', async function() {
                const email = $('#loginEmail').val().trim();
                const password = $('#loginPassword').val();
                
                if (!email || !password) {
                    alert("Veuillez remplir tous les champs");
                    return;
                }
                
                $('#loginBtn').prop('disabled', true).html('<i class="fas fa-spinner fa-spin me-2"></i> Connexion en cours...');
                
                const success = await loginUser(email, password);
                
                if (!success) {
                    $('#loginBtn').prop('disabled', false).html('<i class="fas fa-sign-in-alt me-2"></i> Se connecter');
                }
            });
            
            $('#loginPassword').on('keyup', function(e) {
                if (e.key === 'Enter') {
                    $('#loginBtn').click();
                }
            });
            
            // Navigation entre étapes
            $('#btnToStep2').on('click', function() {
                goToStep(2);
            });
            
            $('#btnToStep1').on('click', function() {
                goToStep(1);
            });
            
            $('#btnToStep3').on('click', async function() {
                // Sauvegarder l'adresse avant de passer à l'étape suivante
                const isValid = validateDeliveryForm();
                if (isValid) {
                    await saveAddressInfo();
                    goToStep(3);
                } else {
                    alert("Veuillez remplir correctement tous les champs obligatoires");
                }
            });
            
            $('#btnToStep2').on('click', function() {
                goToStep(2);
            });
            
            $('#btnToStep4').on('click', function() {
                goToStep(4);
            });
            
            $('#btnToStep3').on('click', function() {
                goToStep(3);
            });
            
            $('#btnConfirmOrder').on('click', finalizeOrder);
            
            // Suivi de commande
            $('#btnTrackOrder').on('click', function() {
                alert('La fonctionnalité de suivi sera disponible sous peu. Vous recevrez un lien de suivi par SMS.');
            });
            
            // Options de livraison
            $('.delivery-option').on('click', function() {
                $('.delivery-option').removeClass('selected');
                $(this).addClass('selected');
                deliveryOption = $(this).data('type');
                updateSummary();
            });
            
            // Méthodes de paiement
            $('.payment-option').on('click', function() {
                $('.payment-option').removeClass('selected');
                $(this).addClass('selected');
                paymentMethod = $(this).data('method');
                updateSummary();
            });
            
            // Validation des formulaires
            $('#deliveryName, #deliveryPhone, #deliveryEmail, #deliveryCity, #deliveryDistrict, #deliveryAddress').on('input', function() {
                updateNavigationButtons();
            });
            
            $('#acceptTerms').on('change', function() {
                updateNavigationButtons();
            });
            
            $('#finalConfirmation').on('change', function() {
                updateNavigationButtons();
            });
            
            // Gestion des quantités
            $(document).on('click', '.quantity-btn', function() {
                const productId = $(this).data('id');
                const input = $(`.quantity-input[data-id="${productId}"]`);
                let quantity = parseInt(input.val());
                
                if ($(this).hasClass('plus')) {
                    quantity++;
                } else if ($(this).hasClass('minus')) {
                    quantity--;
                }
                
                // Limiter à 1-100
                quantity = Math.max(1, Math.min(100, quantity));
                input.val(quantity);
                
                // Mettre à jour le panier
                if (userCart.items[productId]) {
                    userCart.items[productId].quantity = quantity;
                    updateCartInFirestore();
                    updateCartDisplay();
                    updateSummary();
                }
            });
            
            // Mise à jour manuelle de la quantité
            $(document).on('change', '.quantity-input', function() {
                const productId = $(this).data('id');
                let quantity = parseInt($(this).val());
                
                // Valider l'entrée
                if (isNaN(quantity) || quantity < 1) quantity = 1;
                if (quantity > 100) quantity = 100;
                
                $(this).val(quantity);
                
                // Mettre à jour le panier
                if (userCart.items[productId]) {
                    userCart.items[productId].quantity = quantity;
                    updateCartInFirestore();
                    updateCartDisplay();
                    updateSummary();
                }
            });
            
            // Supprimer un article
            $(document).on('click', '.cart-item-remove', function() {
                const productId = $(this).data('id');
                if (confirm("Supprimer cet article du panier ?")) {
                    delete userCart.items[productId];
                    updateCartInFirestore();
                    updateCartDisplay();
                    updateSummary();
                }
            });
            
            // Code promotionnel
            $('#applyDiscount').on('click', function() {
                const code = $('#discountCode').val().trim();
                if (code) {
                    applyDiscountCode(code);
                }
            });
            
            $('#discountCode').on('keyup', function(e) {
                if (e.key === 'Enter') {
                    $('#applyDiscount').click();
                }
            });
            
            // Recherche
            $('.search-btn').on('click', function() {
                const term = $('.search-input').val().trim();
                if (term) {
                    window.location.href = `dashboard.html?search=${encodeURIComponent(term)}`;
                }
            });
            
            $('.search-input').on('keyup', function(e) {
                if (e.key === 'Enter') {
                    $('.search-btn').click();
                }
            });
            
            // Navigation footer
            $('.footer-item').on('click', function(e) {
                if ($(this).attr('href') === '#') {
                    e.preventDefault();
                }
                $('.footer-item').removeClass('active');
                $(this).addClass('active');
            });
            
            // Initialiser l'affichage
            updateCartDisplay();
            updateSummary();
            updateNavigationButtons();
        });
    </script>
</body>
</html>